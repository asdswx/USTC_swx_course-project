print(p1)
print(p2)
print(mean(Xn))
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-0
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sigma*tau/(n*tau+sigma)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(mean(Xn))
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-0
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sigma*tau/(n*tau+sigma)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(pnorm(0.5,postheta,possigma))
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-0
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sigma*tau/(n*tau+sigma)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(pnorm(0,postheta,possigma))
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-0
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sigma*tau/(n*tau+sigma)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-0
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sqrt(sigma*tau/(n*tau+sigma))
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-1
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sqrt(sigma*tau/(n*tau+sigma))
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
a<-pnorm(3,postheta,possigma)-pnorm(-3,postheta,possigma)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(a)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp((x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp((x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-integrate(f,-3,3)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(a)
View(a)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(a)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
b<-integrate(x,-3,3)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
b<-integrate(f1,-3,3)
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
print(a)
View(b)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f,-0.5,0.5)
##-0.2~0.6
p2<-integrate(f,-0.2,0.6)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)^2/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
y<-c(seq(-3,3,0.01))
plot(y,f(y))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
y<-c(seq(-3,3,0.01))
plot(y,f(y))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
plot(y,f1(y))
##-0.5~0.5
p1<-integrate(f,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
y<-c(seq(-3,3,0.01))
plot(y,f(y))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
plot(y,f1(y))
plot(y,dnorm(y,postheta,possigma))
##-0.5~0.5
p1<-integrate(f,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-1
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sqrt(sigma*tau/(n*tau+sigma))
y<-c(seq(-3,3,0.01))
plot(y,dnorm(y,postheta,possigma))
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
mu<-1
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sqrt(sigma*tau/(n*tau+sigma))
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f1,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f1,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f1,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f1,-0.2,0.6)$value
print(p1)
print(p2)
##之前算的后验密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optim(0,f1)
View(opt)
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optim(0,f1)
View(opt)
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optim(0,f1,interval=c(-3,3))
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optimize(0,f1,interval=c(-3,3))
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optimize(f1,interval=c(-3,3))
View(opt)
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optimize(f1,interval=c(-3,3))
##正态逼近的后验均值
posmu<-opt$minimum
##正态逼近的后验标准差
possigma<-sqrt(sigma/n)
##-0.5~0.5
p1<-pnorm(0.5,posmu,possigma)-pnorm(-0.5,posmu,possigma)
##-0.2~0.6
p2<-pnorm(0.6,posmu,possigma)-pnorm(-0.2,posmu,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30,1,1)##从N(1,1)中抽出30个样本
sigma<-1
n<-30
mu<-0
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sqrt(sigma*tau/(n*tau+sigma))
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30,1,1)##从N(1,1)中抽出30个样本
sigma<-1
n<-30
mu<-1
tau<-2
##一些参数
postheta<-sigma/n/(sigma/n+tau)*mu+tau/(tau+sigma/n)*mean(Xn)
possigma<-sqrt(sigma*tau/(n*tau+sigma))
##-0.5~0.5
p1<-pnorm(0.5,postheta,possigma)-pnorm(-0.5,postheta,possigma)
##-0.2~0.6
p2<-pnorm(0.6,postheta,possigma)-pnorm(-0.2,postheta,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30,1,1)##从N(1,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
f<-function(x) exp(-(x-postheta)*(x-postheta)/(2*sigma/n))
##密度函数前面的系数
a<-1/integrate(f,-3,3)$value
##密度函数
f1<-function(x) a*exp(-(x-postheta)^2/(2*sigma/n))
##-0.5~0.5
p1<-integrate(f1,-0.5,0.5)$value
##-0.2~0.6
p2<-integrate(f1,-0.2,0.6)$value
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30)##从N(0,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optimize(f1,interval=c(-3,3))
##正态逼近的后验均值
posmu<-opt$minimum
##正态逼近的后验标准差
possigma<-sqrt(sigma/n)
##-0.5~0.5
p1<-pnorm(0.5,posmu,possigma)-pnorm(-0.5,posmu,possigma)
##-0.2~0.6
p2<-pnorm(0.6,posmu,possigma)-pnorm(-0.2,posmu,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30,1,1)##从N(1,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optimize(f1,interval=c(-3,3))
##正态逼近的后验均值
posmu<-opt$minimum
##正态逼近的后验标准差
possigma<-sqrt(sigma/n)
##-0.5~0.5
p1<-pnorm(0.5,posmu,possigma)-pnorm(-0.5,posmu,possigma)
##-0.2~0.6
p2<-pnorm(0.6,posmu,possigma)-pnorm(-0.2,posmu,possigma)
print(p1)
print(p2)
set.seed(1)##先固定随机出一组随机数
Xn<-rnorm(30,1,1)##从N(1,1)中抽出30个样本
sigma<-1
n<-30
##一些参数
postheta<-mean(Xn)
possigma<-sqrt(sigma/n)
##之前算的后验密度函数
f1<-function(x) -a*exp(-(x-postheta)^2/(2*sigma/n))
opt<-optimize(f1,interval=c(-3,3))
##正态逼近的后验均值
posmu<-opt$minimum
##正态逼近的后验标准差
possigma<-sqrt(sigma/n)
##-0.5~0.5
p1<-pnorm(0.5,posmu,possigma)-pnorm(-0.5,posmu,possigma)
##-0.2~0.6
p2<-pnorm(0.6,posmu,possigma)-pnorm(-0.2,posmu,possigma)
print(p1)
print(p2)
