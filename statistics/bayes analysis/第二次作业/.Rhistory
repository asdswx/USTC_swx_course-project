qnorm(0.25)
qnorm(0)
qnorm(0.5)
qnorm(0.75)
qnorm(0.05)
y<-function(x)
exp(-(6-x)^2/2)/(1+x^2)
curve(y,-5,15)
print(integrate(y,-Inf,Inf))
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
curve(pithetax,-5,15)
print(integrate(pithetax,-Inf,Inf))
hpd<-function(p,f,a){
area=0
k=0.2
#要求根的函数
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15)) #右端点
x2=uniroot(fk,c(-5,5.66)) #左端点
area=integrate(f,x2$root,x1$root)$value
table<-cbind(k,area)
while(abs(area-p)>10^(-3)){
if(area>p)
k<-k+a
hpd<-function(p,f,a){
area=0
k=0.2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k#要求根的函数
x1=uniroot(fk,c(5.66,15)) #右端点
x2=uniroot(fk,c(-5,5.66)) #左端点
area=integrate(f,x2$root,x1$root)$value
table<-cbind(k,area)
while(abs(area-p)>10^(-3)){
if(area>p)
k<-k+a
else
k<-k-a
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
table1<-cbind(k,area)
table<-rbind(table,table1)
}
#print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax,0.0005)
print(interval)
opty<-function(x)#求该函数的极小，对应原函数的极大
-exp(-(6-x)^2/2)/(1+x^2)/0.0738
qaq<-optimize(opty,c(-5,15))
print(qaq)
hpd<-function(p,f,a){
area=0
k=0.2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k#要求根的函数
x1=uniroot(fk,c(5.66,15)) #右端点
x2=uniroot(fk,c(-5,5.66)) #左端点
area=integrate(f,x2$root,x1$root)$value
table<-cbind(k,area)
while(abs(area-p)>10^(-3)){
if(area>p)
k<-k+a
else
k<-k-a
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
table1<-cbind(k,area)
table<-rbind(table,table1)
}
#print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax,0.0001)
print(interval)
hpd<-function(p,f,a){
area=0
k=0.2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k#要求根的函数
x1=uniroot(fk,c(5.66,15)) #右端点
x2=uniroot(fk,c(-5,5.66)) #左端点
area=integrate(f,x2$root,x1$root)$value
table<-cbind(k,area)
while(abs(area-p)>10^(-3)){
if(area>p)
k<-k+a
else
k<-k-a
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
table1<-cbind(k,area)
table<-rbind(table,table1)
}
#print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax,0.00001)
print(interval)
hpd<-function(p,f,a){
area=0
k=0.2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k#要求根的函数
x1=uniroot(fk,c(5.66,15)) #右端点
x2=uniroot(fk,c(-5,5.66)) #左端点
area=integrate(f,x2$root,x1$root)$value
table<-cbind(k,area)
while(abs(area-p)>10^(-5)){
if(area>p)
k<-k+a
else
k<-k-a
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
table1<-cbind(k,area)
table<-rbind(table,table1)
}
#print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax,0.00001)
print(interval)
hpd<-function(p,f){
area=0
k1=0 #f不会小于0
k2=0.4 #f不会大于0.4
repeat{
k=(k1+k2)/2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
if(area>p)
k1=k
else
k2=k
table1<-cbind(k,area)
table<-rbind(table,table1)
}while(abs(area-p)<10^(-5))
hpd<-function(p,f){
area=0
k1=0 #f不会小于0
k2=0.4 #f不会大于0.4
repeat{
k=(k1+k2)/2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
if(area>p)
k1=k
else
k2=k
table1<-cbind(k,area)
table<-rbind(table,table1)
if(abs(area-p)<10^-5)
break
}
#print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax)
hpd<-function(p,f){
area=0
k=1
k1=0 #f不会小于0
k2=0.4 #f不会大于0.4
table=cbind(k,area)
repeat{
k=(k1+k2)/2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
if(area>p)
hpd<-function(p,f){
area=0
k=1
k1=0 #f不会小于0
k2=0.4 #f不会大于0.4
table<-cbind(k,area)
repeat{
k=(k1+k2)/2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
if(area>p)
k1=k
else
hpd<-function(p,f){
area=0
k=1
k1=0 #f不会小于0
k2=0.4 #f不会大于0.4
table<-cbind(k,area)
repeat{
k=(k1+k2)/2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
if(area>p)k1=k else k2=k
table1<-cbind(k,area)
table<-rbind(table,table1)
if(abs(area-p)<10^-5)
break
}
#print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax)
print(interval)
hpd<-function(p,f){
area=0
k=1
k1=0 #f不会小于0
k2=0.4 #f不会大于0.4
table<-cbind(k,area)
repeat{
k=(k1+k2)/2
fk<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738-k
x1=uniroot(fk,c(5.66,15))
x2=uniroot(fk,c(-5,5.66))
area=integrate(f,x2$root,x1$root)$value
if(area>p)k1=k else k2=k
table1<-cbind(k,area)
table<-rbind(table,table1)
if(abs(area-p)<10^-5)
break
}
print(table)
return (c(x2$root,x1$root))
}
pithetax<-function(x)
exp(-(6-x)^2/2)/(1+x^2)/0.0738
interval<-hpd(0.95,pithetax)
print(interval)
qnorm(0.25)
print(qnorm(0.25))
print(qnorm(0.25))
print(1/qnorm(0.75))
print((1/qnorm(0.75))^2)
tau2=(1/qnorm(0.75))^2
print(6*tau2/(tau2+1))
print(tau2/(tau2+1))
tau2=(1/qnorm(0.75))^2
c=qnorm(0.95,6*tau2/(tau2+1),tau2/(tau2+1))
print(c)
c=qnorm(0.95)
print(c)
c=qnorm(0.95)
tau2=(1/qnorm(0.75))^2
tau1=tau2/(tau2+1)
mu1=6*tau2/(tau2+1)
print(-c*tau1+mu1)
print(c*tau1+mu1)
c=qnorm(0.95)
tau2=(1/qnorm(0.75))^2
tau1=sqrt(tau2/(tau2+1))
mu1=6*tau2/(tau2+1)
print(-c*tau1+mu1)
print(c*tau1+mu1)
tau2=1
alpha1=0.25
n=10
mu=10
x=c(9.45,10.62,9.40,10.12,9.85,10.92,10.93,9.85,9.81,10.28)
mx=mean(X)
tau2=1
alpha1=0.25
n=10
mu=10
x=c(9.45,10.62,9.40,10.12,9.85,10.92,10.93,9.85,9.81,10.28)
mx=mean(x)
mu1=(tau2*x+alpha1/n*mu)/(tau2+alpha1/n)
eta1=(tau2*alpha1/n)/(tau2+alpha1/n)
print(mu1)
print(eta1)
tau2=1
alpha1=0.25
n=10
mu=10
x=c(9.45,10.62,9.40,10.12,9.85,10.92,10.93,9.85,9.81,10.28)
mx=mean(x)
mu1=(tau2*mx+alpha1/n*mu)/(tau2+alpha1/n)
eta1=(tau2*alpha1/n)/(tau2+alpha1/n)
print(mu1)
print(eta1)
eta2=eta1+tau2
print(eta2)
eta2=eta1+alpha1
print(eta2)
eta2=eta1+alpha1
print(mu1)
print(eta2)
print(mu2-sqrt(eta2)*qnorm(0.975))
eta2=eta1+alpha1
mu2=mu1
print(mu2)
print(eta2)
print(mu2-sqrt(eta2)*qnorm(0.975))
print(mu2+sqrt(eta2)*qnorm(0.975))
