"0","r1=cor(q,d)"
"0","r1"
"1","[1]"
"1"," 0.9770792"
"1","
"
"0","## transform"
"0","normal<-function(lambda){"
"0","  u1<-lambda[1]"
"0","  u2<-lambda[2]"
"0","  n=length(x1)"
"0","ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)"
"0","ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)"
"0","i=cbind(i1,i2)"
"0","L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))"
"0"," return(-L)"
"0","}"
"0","result<-optim(par=c(1,1),normal)"
"0","result"
"1","$par
"
"1","[1]"
"1","  0.2395004"
"1"," -0.6412501"
"1","
"
"1","
"
"1","$value
"
"1","[1]"
"1"," 74.61358"
"1","
"
"1","
"
"1","$counts
"
"1","function "
"1","gradient "
"1","
"
"1","      67 "
"1","      NA "
"1","
"
"1","
"
"1","$convergence
"
"1","[1]"
"1"," 0"
"1","
"
"1","
"
"1","$message
"
"1","NULL
"
"1","
"
"0","## draw chi-square plot after"
"0","y=cbind(x[,1]^0.24,x[,2]^(-0.64))"
"0","m=colMeans(y)"
"0","ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)"
"0","s=cov(y)"
"0","ym=t(ym)"
"0","d=t(ym)%*%solve(s)%*%ym"
"0","d=diag(d)"
"0","d=d[order(d)]"
"0","q<-qchisq(seq(1/50,49/50,1/25),2)"
"0","plot(q,d)"
