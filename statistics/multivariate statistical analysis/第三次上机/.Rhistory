##independent
library(MASS)
y=x[,c(1,2,5)]
qwq<-c(0,0,0)
qaq<-c(0,0,0)
for (i in 1:3){
bo<-boxcox(y[,i]~1)
x2<-bo$x
y2<-bo$y
lik<-cbind(x2,y2)
lik<-lik[order(-y2),]
qwq[i]=lik[1,1]
}
qwq[3]=1
for(i in 1:3){
b<-qqnorm(x[,i]^qwq[i])
qqline(x[,i]^qwq[i])
x1<-b$x
y1<-b$y
qaq[i]=cor(x1,y1)
}
qaq
##independent
library(MASS)
y=x[,c(1,2,5)]
qwq<-c(0,0,0)
qaq<-c(0,0,0)
for (i in 1:3){
bo<-boxcox(y[,i]~1)
x2<-bo$x
y2<-bo$y
lik<-cbind(x2,y2)
lik<-lik[order(-y2),]
qwq[i]=lik[1,1]
}
for(i in 1:3){
b<-qqnorm(y[,i]^qwq[i])
qqline(y[,i]^qwq[i])
x1<-b$x
y1<-b$y
qaq[i]=cor(x1,y1)
}
qaq
x<-read.table("T3-2.DAT")
plot(x)
x<-read.table("T3-2.DAT")
plot(x)
fit<-lm(x[,2]~x[,1])
x<-read.table("T3-2.DAT")
plot(x)
fit<-lm(x[,2]~x[,1])
fit
View(x)
x<-read.table("T3-2.DAT")
plot(x)
fit<-lm(x[,2]~x[,1])
fit
abline(x,10.296+0.9529x)
x<-read.table("T3-2.DAT")
plot(x)
fit<-lm(x[,2]~x[,1])
fit
abline(x[,1],10.296+0.9529x[,1])
x<-read.table("T3-2.DAT")
plot(x)
fit<-lm(x[,2]~x[,1])
fit
abline(a=10.296,b=0.9529)
x<-read.table("T3-2.DAT")
plot(x,xlab="duration",ylab="numbers of hours")
fit<-lm(x[,2]~x[,1])
fit
abline(a=10.296,b=0.9529)
x<-read.table("T3-2.DAT")
plot(x,xlab="duration",ylab="numbers of hours")
fit<-lm(x[,2]~x[,1])
fit
abline(a=10.296,b=0.9529)
lambda=c(0,0)
library(MASS)
for(i in 1:2){
b<-boxcox(x[,i]~1)
x1<-b$x
y1<-b$y
lik<-cbind(x1,y1)
lik<-lik[order(-y1),]
lambda[i]=lik[1,1]
}
lambda
x=read.table("T3-2.DAT")
rq1<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i])
qqline(x[,i])
x1<-b$x
y1<-b$y
r[i]=cor(x1,y1)
}
r
x=read.table("T3-2.DAT")
rq1<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i])
qqline(x[,i])
x1<-b$x
y1<-b$y
rq1[i]=cor(x1,y1)
}
rq1
x=read.table("T3-2.DAT")
rq2<-c(0,0)
for(i in 1:3){
b<-qqnorm(x[,i]^lambda[i])
qqline(y[,i]^lambda[i])
x1<-b$x
y1<-b$y
rq2[i]=cor(x1,y1)
}
x=read.table("T3-2.DAT")
rq2<-c(0,0)
for(i in 1:3){
b<-qqnorm(x[,i]^lambda[i])
qqline(x[,i]^lambda[i])
x1<-b$x
y1<-b$y
rq2[i]=cor(x1,y1)
}
x=read.table("T3-2.DAT")
rq2<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i]^lambda[i])
qqline(x[,i]^lambda[i])
x1<-b$x
y1<-b$y
rq2[i]=cor(x1,y1)
}
rq2
x<-read.table("T3-2.DAT")
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
x<-read.table("T3-2.DAT")
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
y=cbind(x[,1]^0.24,x[,2]^(-0.64))
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(d,q)
r1=cor(d,q)
r1
x<-read.table("T3-2.DAT")
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
y=cbind(x[,1]^0.24,x[,2]^(-0.64))
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
## chi-square before
x<-read.table("T3-2.DAT")
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
## transform
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
## draw chi-square plot after
y=cbind(x[,1]^0.24,x[,2]^(-0.64))
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
## chi-square before
x<-read.table("T3-2.DAT")
m=colMeans(x)
xm=x-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(x)
xm=t(xm)
d=t(xm)%*%solve(s)%*%xm
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
## transform
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
## draw chi-square plot after
y=cbind(x[,1]^0.24,x[,2]^(-0.64))
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
knitr::opts_chunk$set(echo = TRUE)
x=read.table("T4-6.DAT")
r=c(0,0,0,0,0)
for(i in 1:5){
b<-qqnorm(x[,i])
qqline(x[,i])
x1<-b$x
y1<-b$y
r[i]=cor(x1,y1)
}
r
m=colMeans(x[,1:5])
xm=x[,1:5]-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=5)))%*%diag(m)
s=cov(x[,1:5])
xm=t(xm)
d=t(xm)%*%solve(s)%*%xm
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/260,259/260,1/130),5)
plot(d,q)
r1=cor(d,q)
r1
library(MASS)
y=x[,c(1,2,5)]
qwq<-c(0,0,0)
qaq<-c(0,0,0)
for (i in 1:3){
bo<-boxcox(y[,i]~1)
x2<-bo$x
y2<-bo$y
lik<-cbind(x2,y2)
lik<-lik[order(-y2),]
qwq[i]=lik[1,1]
}
for(i in 1:3){
b<-qqnorm(y[,i]^qwq[i])
qqline(y[,i]^qwq[i])
x1<-b$x
y1<-b$y
qaq[i]=cor(x1,y1)
}
qaq
x<-read.table("T3-2.DAT")
plot(x,xlab="duration",ylab="numbers of hours")
fit<-lm(x[,2]~x[,1])
fit
abline(a=10.296,b=0.9529)
x=read.table("T3-2.DAT")
rq1<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i])
qqline(x[,i])
x1<-b$x
y1<-b$y
rq1[i]=cor(x1,y1)
}
rq1
lambda=c(0,0)
library(MASS)
for(i in 1:2){
b<-boxcox(x[,i]~1)
x1<-b$x
y1<-b$y
lik<-cbind(x1,y1)
lik<-lik[order(-y1),]
lambda[i]=lik[1,1]
}
lambda
x=read.table("T3-2.DAT")
rq2<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i]^lambda[i])
qqline(x[,i]^lambda[i])
x1<-b$x
y1<-b$y
rq2[i]=cor(x1,y1)
}
rq2
## chi-square before
x<-read.table("T3-2.DAT")
m=colMeans(x)
xm=x-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(x)
xm=t(xm)
d=t(xm)%*%solve(s)%*%xm
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
## transform
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
## draw chi-square plot after
y=cbind(x[,1]^0.24,x[,2]^(-0.64))
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
knitr::opts_chunk$set(echo = TRUE)
x=read.table("T4-6.DAT")
r=c(0,0,0,0,0)
for(i in 1:5){
b<-qqnorm(x[,i])
qqline(x[,i])
x1<-b$x
y1<-b$y
r[i]=cor(x1,y1)
}
r
m=colMeans(x[,1:5])
xm=x[,1:5]-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=5)))%*%diag(m)
s=cov(x[,1:5])
xm=t(xm)
d=t(xm)%*%solve(s)%*%xm
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/260,259/260,1/130),5)
plot(d,q)
r1=cor(d,q)
r1
library(MASS)
y=x[,c(1,2,5)]
qwq<-c(0,0,0)
qaq<-c(0,0,0)
for (i in 1:3){
bo<-boxcox(y[,i]~1)
x2<-bo$x
y2<-bo$y
lik<-cbind(x2,y2)
lik<-lik[order(-y2),]
qwq[i]=lik[1,1]
}
for(i in 1:3){
b<-qqnorm(y[,i]^qwq[i])
qqline(y[,i]^qwq[i])
x1<-b$x
y1<-b$y
qaq[i]=cor(x1,y1)
}
qaq
x<-read.table("T3-2.DAT")
plot(x,xlab="duration",ylab="numbers of hours")
fit<-lm(x[,2]~x[,1])
fit
abline(a=10.296,b=0.9529)
x=read.table("T3-2.DAT")
rq1<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i])
qqline(x[,i])
x1<-b$x
y1<-b$y
rq1[i]=cor(x1,y1)
}
rq1
lambda=c(0,0)
library(MASS)
for(i in 1:2){
b<-boxcox(x[,i]~1)
x1<-b$x
y1<-b$y
lik<-cbind(x1,y1)
lik<-lik[order(-y1),]
lambda[i]=lik[1,1]
}
lambda
x=read.table("T3-2.DAT")
rq2<-c(0,0)
for(i in 1:2){
b<-qqnorm(x[,i]^lambda[i])
qqline(x[,i]^lambda[i])
x1<-b$x
y1<-b$y
rq2[i]=cor(x1,y1)
}
rq2
## chi-square before
x<-read.table("T3-2.DAT")
m=colMeans(x)
xm=x-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(x)
xm=t(xm)
d=t(xm)%*%solve(s)%*%xm
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
## transform
normal<-function(lambda){
u1<-lambda[1]
u2<-lambda[2]
n=length(x1)
ifelse(u1==0,i1<-log(x[,1]),i1<-(x[,1]^u1-1)/u1)
ifelse(u2==0,i2<-log(x[,2]),i2<-(x[,2]^u2-1)/u2)
i=cbind(i1,i2)
L=-n/2*log(det((n-1)*cov(i)/n))+(u1-1)*sum(log(x[,1]))+(u2-1)*sum(log(x[,2]))
return(-L)
}
result<-optim(par=c(1,1),normal)
result
## draw chi-square plot after
y=cbind(x[,1]^0.24,x[,2]^(-0.64))
m=colMeans(y)
ym=y-c(rep(1,times=length(x[,1])))%*%t(c(rep(1,times=2)))%*%diag(m)
s=cov(y)
ym=t(ym)
d=t(ym)%*%solve(s)%*%ym
d=diag(d)
d=d[order(d)]
q<-qchisq(seq(1/50,49/50,1/25),2)
plot(q,d)
r1=cor(q,d)
r1
