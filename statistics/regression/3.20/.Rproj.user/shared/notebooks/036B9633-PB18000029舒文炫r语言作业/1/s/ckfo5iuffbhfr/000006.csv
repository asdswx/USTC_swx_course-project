"0","import=read.table(""1.txt"",header = TRUE)"
"0","##标准化x"
"0","x<-import[,1:4]"
"0","xm=colMeans(x)"
"0","c=9*cov(x)"
"0","xc<-x-matrix(rep(1,10),nrow = 10)%*%t(xm)"
"0","xs<-matrix(rep(0,40),ncol=4)"
"0","for(i in 1:4)"
"0","  xs[,i]<-xc[,i]*1/sqrt(c[i,i])"
"0","##标准化y"
"0","y=import[,5]"
"0","yc=y-mean(y)"
"0","syy<-crossprod(yc)"
"0","s<-1/sqrt(syy)"
"0","ys<-yc%*%s"
"0",""
"0","s=t(xs)%*%xs"
"0","eig=eigen(s)"
"0","lambda<-eig$val"
"0","vect<-eig$vec"
"0","print(lambda)"
"1","[1]"
"1"," 3.943813553"
"1"," 0.039962805"
"1"," 0.012586520"
"1"," 0.003637121"
"1","
"
"0","print(vect)"
"1","    "
"1","       [,1]"
"1","       [,2]"
"1","       [,3]"
"1","       [,4]"
"1","
[1,]"
"1"," -0.5015908"
"1"," -0.2371037"
"1","  0.5788473"
"1","  0.5975988"
"1","
[2,]"
"1"," -0.4997889"
"1","  0.4926217"
"1"," -0.6104554"
"1","  0.3672588"
"1","
[3,]"
"1"," -0.4979539"
"1"," -0.7068667"
"1"," -0.3682957"
"1"," -0.3416720"
"1","
[4,]"
"1"," -0.5006593"
"1","  0.4488265"
"1","  0.3957754"
"1"," -0.6255053"
"1","
"
"0","##0.00364很小，我们剔除第四个主成分"
"0","lambda1=lambda[1:3]"
"0","vect1=vect[,1:3]"
"0","lambda1=diag(lambda1)"
"0","beta=vect1%*%solve(lambda1)%*%t(vect1)%*%t(xs)%*%ys"
"0","print(""偏回归系数为"")"
"1","[1]"
"1"," ""偏回归系数为"""
"1","
"
"0","beta2=0"
"0","for(i in 1:4)"
"0","  beta2[i]=beta[i]/sqrt(c[i,i])*sqrt(syy)"
"0","print(beta2) "
"1","[1]"
"1","  0.098224731"
"1"," -0.208825160"
"1","  0.004921882"
"1","  0.372189126"
"1","
"
"0","print(""常数项为"")"
"1","[1]"
"1"," ""常数项为"""
"1","
"
"0","alpha=(mean(y)-t(beta2)%*%xm)"
"0","print(alpha)"
"1","    "
"1","      [,1]"
"1","
[1,]"
"1"," -15.58202"
"1","
"
